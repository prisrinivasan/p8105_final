<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Kelly</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.9.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-1.46.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-1.46.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="Overview.html">Report</a>
</li>
<li>
  <a href="https://prisrinivasan.shinyapps.io/roach_shiny/">Find Your Neighborhood</a>
</li>
<li>
  <a href="mailto:&lt;bowlin.hannah@columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/prisrinivasan/p8105_final/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Kelly</h1>

</div>


<pre class="r"><code>all_available_data=
  read_csv(file=&quot;./final_data/all_available_data.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   unique_id = col_double(),
##   indicator_id = col_double(),
##   name = col_character(),
##   measure = col_character(),
##   geo_type_name = col_character(),
##   geo_join_id = col_double(),
##   geo_place_name = col_character(),
##   time_period = col_character(),
##   start_date = col_date(format = &quot;&quot;),
##   data_value = col_double(),
##   message = col_character(),
##   confidence_interval = col_logical()
## )</code></pre>
<pre><code>## Warning: 42367 parsing failures.
##  row                 col           expected       actual                                  file
## 5332 confidence_interval 1/0/T/F/TRUE/FALSE (38.1, 45.8) &#39;./final_data/all_available_data.csv&#39;
## 5334 confidence_interval 1/0/T/F/TRUE/FALSE (29.7, 35.1) &#39;./final_data/all_available_data.csv&#39;
## 5336 confidence_interval 1/0/T/F/TRUE/FALSE (21.5, 27.5) &#39;./final_data/all_available_data.csv&#39;
## 5338 confidence_interval 1/0/T/F/TRUE/FALSE (30.9, 37.1) &#39;./final_data/all_available_data.csv&#39;
## 5340 confidence_interval 1/0/T/F/TRUE/FALSE (28.2, 38.4) &#39;./final_data/all_available_data.csv&#39;
## .... ................... .................. ............ .....................................
## See problems(...) for more details.</code></pre>
<pre class="r"><code>Asthma_data=
  read_csv(file=&quot;./final_data/asthma_data.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   indicator_data_id = col_double(),
##   indicator_id = col_double(),
##   name = col_character(),
##   Measure = col_character(),
##   geo_type_name = col_character(),
##   geo_entity_id = col_double(),
##   year_description = col_double(),
##   data_value = col_character(),
##   message = col_character()
## )</code></pre>
<pre><code>## Warning: 3486 parsing failures.
##  row              col expected              actual                           file
## 5167 year_description a double Annual Average 2009 &#39;./final_data/asthma_data.csv&#39;
## 5168 year_description a double Annual Average 2009 &#39;./final_data/asthma_data.csv&#39;
## 5169 year_description a double Annual Average 2009 &#39;./final_data/asthma_data.csv&#39;
## 5170 year_description a double Annual Average 2009 &#39;./final_data/asthma_data.csv&#39;
## 5171 year_description a double Annual Average 2009 &#39;./final_data/asthma_data.csv&#39;
## .... ................ ........ ................... ..............................
## See problems(...) for more details.</code></pre>
<pre class="r"><code>mold_data=
  read_csv(file=&quot;./final_data/mold_home.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   indicator_data_id = col_double(),
##   indicator_id = col_double(),
##   name = col_character(),
##   Measure = col_character(),
##   geo_type_name = col_character(),
##   geo_entity_id = col_double(),
##   year_description = col_double(),
##   data_value = col_character(),
##   message = col_character()
## )</code></pre>
<pre><code>## Warning: 378 parsing failures.
##  row              col               expected actual                         file
## 1975 year_description no trailing characters  -2013 &#39;./final_data/mold_home.csv&#39;
## 1976 year_description no trailing characters  -2013 &#39;./final_data/mold_home.csv&#39;
## 1977 year_description no trailing characters  -2013 &#39;./final_data/mold_home.csv&#39;
## 1978 year_description no trailing characters  -2013 &#39;./final_data/mold_home.csv&#39;
## 1979 year_description no trailing characters  -2013 &#39;./final_data/mold_home.csv&#39;
## .... ................ ...................... ...... ............................
## See problems(...) for more details.</code></pre>
<div id="kelly-vision-x-borough-name-y-cockroach-rate-by-different-boroughs" class="section level3">
<h3>Kelly vision: X : borough name , Y: Cockroach Rate, by different boroughs</h3>
<div id="trying-to-include-boroughs-in-hereusing-alices-method-to-include-borough-name" class="section level4">
<h4>Trying to include Borough’s in here–using Alice’s Method to include Borough name</h4>
<pre class="r"><code>library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre class="r"><code>tidy_asthma = 
  read_csv(file = &quot;./final_data/tidy_asthma.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   geo_type_name = col_character(),
##   geo_join_id = col_double(),
##   time_period = col_double(),
##   geo_place_name = col_character(),
##   homes_with_cockroaches = col_double(),
##   poverty = col_double(),
##   public_school_children_5_14_yrs_old_with_asthma = col_double(),
##   public_school_children_5_14_yrs_old_with_persistent_asthma = col_double(),
##   asthma_hospitalizations_children_5_to_17_yrs_old = col_double()
## )</code></pre>
<pre class="r"><code>tidy_asthma </code></pre>
<pre><code>## # A tibble: 188 x 9
##    geo_type_name geo_join_id time_period geo_place_name homes_with_cock…
##    &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
##  1 Borough                 1        2011 Bronx                      37.7
##  2 Borough                 2        2011 Brooklyn                   26.6
##  3 Borough                 3        2011 Manhattan                  20.6
##  4 Borough                 4        2011 Queens                     19.7
##  5 Borough                 5        2011 Staten Island               5.2
##  6 Borough                 1        2014 Bronx                      35  
##  7 Borough                 2        2014 Brooklyn                   26.4
##  8 Borough                 3        2014 Manhattan                  19.7
##  9 Borough                 4        2014 Queens                     19.3
## 10 Borough                 5        2014 Staten Island               4.8
## # … with 178 more rows, and 4 more variables: poverty &lt;dbl&gt;,
## #   public_school_children_5_14_yrs_old_with_asthma &lt;dbl&gt;,
## #   public_school_children_5_14_yrs_old_with_persistent_asthma &lt;dbl&gt;,
## #   asthma_hospitalizations_children_5_to_17_yrs_old &lt;dbl&gt;</code></pre>
<pre class="r"><code>pp = tidy_asthma %&gt;% 
  mutate(
    geo_join_id = as.numeric(geo_join_id) ) %&gt;% 
  ggplot(aes(x = geo_join_id, y = homes_with_cockroaches)) + 
  geom_point(aes(colour = time_period), alpha = 0.5) +
  labs(title = &quot;Prevalence of Cockroaches in Different Neighborhoods&quot;,
     x = &#39;Geo_ID&#39;, 
     y = &#39;Rate of Homes with Cockroaches(%)&#39;
)
#pp

# gganimate parts
#pp + transition_time(time_period) + labs(title=&quot;Year:{frame_time}&quot;)

#animate(pp, fps = 2, height = 600, width = 1000)</code></pre>
</div>
</div>
<div id="using-lorraines-code-as-a-guide" class="section level2">
<h2>using lorraine’s code as a guide</h2>
<pre class="r"><code>test_prev=
  tidy_asthma %&gt;% 
  drop_na(homes_with_cockroaches) %&gt;% 
  mutate(
    geo_join_id=as.numeric(geo_join_id),
    time_period=as.factor(time_period),
    time_period=fct_relevel(time_period, &quot;2011&quot;=&quot;2011&quot;, &quot;2012&quot;=&quot;2012&quot;, &quot;2013&quot; = &quot;2013&quot;, &quot;2014&quot; = &quot;2014&quot;)
  ) %&gt;% 
  arrange(geo_join_id) %&gt;% 
  plot_ly(
    x=~geo_join_id, 
    y=~homes_with_cockroaches,
    color=~geo_join_id,
    frame=~ time_period,
    hoverinfo= &quot;text&quot;,
    type=&quot;scatter&quot;,
    mode=&quot;markers&quot;
  )</code></pre>
<pre><code>## Warning: Unknown levels in `f`: 2012, 2013</code></pre>
<pre class="r"><code>test_prev</code></pre>
<div id="htmlwidget-1e142af77f870834f28d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1e142af77f870834f28d">{"x":{"visdat":{"24ed4e1792ff":["function () ","plotlyVisDat"]},"cur_data":"24ed4e1792ff","attrs":{"24ed4e1792ff":{"x":{},"y":{},"hoverinfo":"text","mode":"markers","color":{},"frame":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"geo_join_id","range":[-24.15,529.15]},"yaxis":{"domain":[0,1],"automargin":true,"title":"homes_with_cockroaches","range":[-1.4265,51.2965]},"hovermode":"closest","showlegend":true,"sliders":[{"currentvalue":{"prefix":"time_period: ","xanchor":"right","font":{"size":16,"color":"rgba(204,204,204,1)"}},"steps":[{"method":"animate","args":[["1"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":true},"mode":"immediate"}],"label":"1","value":"1"},{"method":"animate","args":[["2"],{"transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":true},"mode":"immediate"}],"label":"2","value":"2"}],"visible":true,"pad":{"t":40}}],"updatemenus":[{"type":"buttons","direction":"right","showactive":false,"y":0,"x":0,"yanchor":"top","xanchor":"right","pad":{"t":60,"r":5},"buttons":[{"label":"Play","method":"animate","args":[null,{"fromcurrent":true,"mode":"immediate","transition":{"duration":500,"easing":"linear"},"frame":{"duration":500,"redraw":true}}]}]}],"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504],"y":[37.7,26.6,20.6,19.7,5.2,32.8,23.5,38.8,29.6,44.9,48.9,47.9,21.2,18.5,29.5,39,28.2,22.7,33,21.6,17.5,25.7,35.1,32.5,30.1,42,16.7,11.2,13.7,10.6,13,27.6,14.6,22.2,27.9,16.7,3.6,20.7,19.5,18,20.4,7.9,21.1,9.5,8.2,6.9,1.2],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"mode":"markers","frame":"2011","type":"scatter","marker":{"colorbar":{"title":"geo_join_id","ticklen":2},"cmin":1,"cmax":504,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504],"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":504,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504]}},"xaxis":"x","yaxis":"y"},{"x":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504],"y":[35,26.4,19.7,19.3,4.8,25.04,25.79,35.09,29.38,44.88,43.35,40.17,19.4,18.79,33.49,34.58,26.17,22.83,38.43,25.71,16.3,21.08,31.57,29.43,26.98,35.64,13.09,11.74,14.39,13.66,12.42,29.51,13.71,23.95,25.98,22.23,5.3,17.55,18.64,12.12,19.51,9.24,20.3,9.4,7.57,5.73,0.97],"hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"mode":"markers","frame":"2014","type":"scatter","marker":{"colorbar":{"title":"geo_join_id","ticklen":2},"cmin":1,"cmax":504,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504],"line":{"colorbar":{"title":"","ticklen":2},"cmin":1,"cmax":504,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[1,2,3,4,5,101,102,103,104,105,106,107,201,202,203,204,205,206,207,208,209,210,211,301,302,303,304,305,306,307,308,309,310,401,402,403,404,405,406,407,408,409,410,501,502,503,504]}},"xaxis":"x","yaxis":"y"},{"x":[1,504],"y":[0.97,48.9],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"geo_join_id","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":1,"cmax":504,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[1,504],"line":{"color":"rgba(44,160,44,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"frames":[{"name":"1","data":[],"traces":[0,1]},{"name":"2","data":[],"traces":[0,1]}],"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>## see changes with Hospitalzation by time
set.seed(10)
library(ggplot2)

tidy_asthma=
  read_csv(file=&quot;./final_data/tidy_asthma.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   geo_type_name = col_character(),
##   geo_join_id = col_double(),
##   time_period = col_double(),
##   geo_place_name = col_character(),
##   homes_with_cockroaches = col_double(),
##   poverty = col_double(),
##   public_school_children_5_14_yrs_old_with_asthma = col_double(),
##   public_school_children_5_14_yrs_old_with_persistent_asthma = col_double(),
##   asthma_hospitalizations_children_5_to_17_yrs_old = col_double()
## )</code></pre>
<pre class="r"><code>ggplot_data = 
tidy_asthma %&gt;%
  filter(time_period == c(&quot;2011&quot;, &quot;2014&quot;))

plot_tidy = 
ggplot(ggplot_data, aes(x = homes_with_cockroaches, y = asthma_hospitalizations_children_5_to_17_yrs_old, color = homes_with_cockroaches)) +
  geom_point() + 
  geom_smooth(method = &quot;lm&quot;) +
  facet_grid(~time_period) +
  labs(x = &quot;Percent of Homes with Cockroaches&quot;,
       y = &quot;Percent of School Children Hospitalized from Asthma&quot;,
       title = &quot;Crude Association Homes with Cockroaches and Childhood Asthma Hospitalization&quot;) +
  viridis::scale_color_viridis(aes(color = homes_with_cockroaches), discrete = FALSE)

plot_tidy</code></pre>
<p><img src="kelly_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>test_prev=
  tidy_asthma %&gt;% 
  drop_na(asthma_hospitalizations_children_5_to_17_yrs_old) %&gt;% 
  mutate(
    geo_join_id=as.character(geo_join_id),
   time_period = as.numeric(levels(time_period)) [time_period]
  ) %&gt;% 
  arrange(geo_join_id) %&gt;% 
  plot_ly(
    x=~geo_join_id, 
    y=~asthma_hospitalizations_children_5_to_17_yrs_old,
    color=~geo_join_id,
    frame=~ time_period,
    hoverinfo= &quot;text&quot;,
    type=&quot;scatter&quot;,
    mode=&quot;markers&quot;
  )

test_prev</code></pre>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): n too large, allowed maximum for palette Set2 is 8
## Returning the palette you asked for with that many colors

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): n too large, allowed maximum for palette Set2 is 8
## Returning the palette you asked for with that many colors</code></pre>
<p><div id="htmlwidget-33870a1bae03535be5c7" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-33870a1bae03535be5c7">{"x":{"visdat":{"24ed36eecdce":["function () ","plotlyVisDat"]},"cur_data":"24ed36eecdce","attrs":{"24ed36eecdce":{"x":{},"y":{},"hoverinfo":"text","mode":"markers","color":{},"frame":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"geo_join_id","type":"category","categoryorder":"array","categoryarray":["1","101","102","103","104","105","106","107","2","201","202","203","204","205","206","207","208","209","210","211","3","301","302","303","304","305","306","307","308","309","310","4","401","402","403","404","405","406","407","408","409","410","5","501","502","503","504"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"asthma_hospitalizations_children_5_to_17_yrs_old"},"hovermode":"closest","showlegend":true},"source":"A","config":{"showSendToCloud":false},"data":[{"x":["1","1","1","1"],"y":[55.2,65.6,61,61.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"1","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y"},{"x":["101","101","101","101"],"y":[26.5,38.5,22.4,38.3],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"101","marker":{"color":"rgba(137,188,155,1)","line":{"color":"rgba(137,188,155,1)"}},"textfont":{"color":"rgba(137,188,155,1)"},"error_y":{"color":"rgba(137,188,155,1)"},"error_x":{"color":"rgba(137,188,155,1)"},"line":{"color":"rgba(137,188,155,1)"},"xaxis":"x","yaxis":"y"},{"x":["102","102","102","102"],"y":[44.7,56.6,47,52],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"102","marker":{"color":"rgba(165,181,144,1)","line":{"color":"rgba(165,181,144,1)"}},"textfont":{"color":"rgba(165,181,144,1)"},"error_y":{"color":"rgba(165,181,144,1)"},"error_x":{"color":"rgba(165,181,144,1)"},"line":{"color":"rgba(165,181,144,1)"},"xaxis":"x","yaxis":"y"},{"x":["103","103","103","103"],"y":[56.7,74.5,60.8,64],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"103","marker":{"color":"rgba(187,174,134,1)","line":{"color":"rgba(187,174,134,1)"}},"textfont":{"color":"rgba(187,174,134,1)"},"error_y":{"color":"rgba(187,174,134,1)"},"error_x":{"color":"rgba(187,174,134,1)"},"line":{"color":"rgba(187,174,134,1)"},"xaxis":"x","yaxis":"y"},{"x":["104","104","104","104"],"y":[51,48.9,55.4,46],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"104","marker":{"color":"rgba(207,166,124,1)","line":{"color":"rgba(207,166,124,1)"}},"textfont":{"color":"rgba(207,166,124,1)"},"error_y":{"color":"rgba(207,166,124,1)"},"error_x":{"color":"rgba(207,166,124,1)"},"line":{"color":"rgba(207,166,124,1)"},"xaxis":"x","yaxis":"y"},{"x":["105","105","105","105"],"y":[52.2,67.6,59.4,63.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"105","marker":{"color":"rgba(226,157,114,1)","line":{"color":"rgba(226,157,114,1)"}},"textfont":{"color":"rgba(226,157,114,1)"},"error_y":{"color":"rgba(226,157,114,1)"},"error_x":{"color":"rgba(226,157,114,1)"},"line":{"color":"rgba(226,157,114,1)"},"xaxis":"x","yaxis":"y"},{"x":["106","106","106","106"],"y":[57,69.3,62.5,64.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"106","marker":{"color":"rgba(243,147,104,1)","line":{"color":"rgba(243,147,104,1)"}},"textfont":{"color":"rgba(243,147,104,1)"},"error_y":{"color":"rgba(243,147,104,1)"},"error_x":{"color":"rgba(243,147,104,1)"},"line":{"color":"rgba(243,147,104,1)"},"xaxis":"x","yaxis":"y"},{"x":["107","107","107","107"],"y":[74.3,82,87.6,82.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"107","marker":{"color":"rgba(247,143,105,1)","line":{"color":"rgba(247,143,105,1)"}},"textfont":{"color":"rgba(247,143,105,1)"},"error_y":{"color":"rgba(247,143,105,1)"},"error_x":{"color":"rgba(247,143,105,1)"},"line":{"color":"rgba(247,143,105,1)"},"xaxis":"x","yaxis":"y"},{"x":["2","2","2","2"],"y":[26.6,28.2,29,27.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"2","marker":{"color":"rgba(234,146,121,1)","line":{"color":"rgba(234,146,121,1)"}},"textfont":{"color":"rgba(234,146,121,1)"},"error_y":{"color":"rgba(234,146,121,1)"},"error_x":{"color":"rgba(234,146,121,1)"},"line":{"color":"rgba(234,146,121,1)"},"xaxis":"x","yaxis":"y"},{"x":["201","201","201","201"],"y":[9.4,10.9,10.3,6.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"201","marker":{"color":"rgba(220,149,137,1)","line":{"color":"rgba(220,149,137,1)"}},"textfont":{"color":"rgba(220,149,137,1)"},"error_y":{"color":"rgba(220,149,137,1)"},"error_x":{"color":"rgba(220,149,137,1)"},"line":{"color":"rgba(220,149,137,1)"},"xaxis":"x","yaxis":"y"},{"x":["202","202","202","202"],"y":[29,20.1,26.9,22.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"202","marker":{"color":"rgba(205,152,153,1)","line":{"color":"rgba(205,152,153,1)"}},"textfont":{"color":"rgba(205,152,153,1)"},"error_y":{"color":"rgba(205,152,153,1)"},"error_x":{"color":"rgba(205,152,153,1)"},"line":{"color":"rgba(205,152,153,1)"},"xaxis":"x","yaxis":"y"},{"x":["203","203","203","203"],"y":[49.8,59.9,55.7,54.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"203","marker":{"color":"rgba(188,155,169,1)","line":{"color":"rgba(188,155,169,1)"}},"textfont":{"color":"rgba(188,155,169,1)"},"error_y":{"color":"rgba(188,155,169,1)"},"error_x":{"color":"rgba(188,155,169,1)"},"line":{"color":"rgba(188,155,169,1)"},"xaxis":"x","yaxis":"y"},{"x":["204","204","204","204"],"y":[41.3,51.5,41.3,48.5],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"204","marker":{"color":"rgba(168,157,185,1)","line":{"color":"rgba(168,157,185,1)"}},"textfont":{"color":"rgba(168,157,185,1)"},"error_y":{"color":"rgba(168,157,185,1)"},"error_x":{"color":"rgba(168,157,185,1)"},"line":{"color":"rgba(168,157,185,1)"},"xaxis":"x","yaxis":"y"},{"x":["205","205","205","205"],"y":[12.6,12,15.1,19.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"205","marker":{"color":"rgba(145,160,201,1)","line":{"color":"rgba(145,160,201,1)"}},"textfont":{"color":"rgba(145,160,201,1)"},"error_y":{"color":"rgba(145,160,201,1)"},"error_x":{"color":"rgba(145,160,201,1)"},"line":{"color":"rgba(145,160,201,1)"},"xaxis":"x","yaxis":"y"},{"x":["206","206","206","206"],"y":[6.7,5.3,6.2,4.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"206","marker":{"color":"rgba(155,158,202,1)","line":{"color":"rgba(155,158,202,1)"}},"textfont":{"color":"rgba(155,158,202,1)"},"error_y":{"color":"rgba(155,158,202,1)"},"error_x":{"color":"rgba(155,158,202,1)"},"line":{"color":"rgba(155,158,202,1)"},"xaxis":"x","yaxis":"y"},{"x":["207","207","207","207"],"y":[31.3,49.7,35.1,41.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"207","marker":{"color":"rgba(170,155,201,1)","line":{"color":"rgba(170,155,201,1)"}},"textfont":{"color":"rgba(170,155,201,1)"},"error_y":{"color":"rgba(170,155,201,1)"},"error_x":{"color":"rgba(170,155,201,1)"},"line":{"color":"rgba(170,155,201,1)"},"xaxis":"x","yaxis":"y"},{"x":["208","208","208","208"],"y":[21.6,20.8,26.9,24.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"208","marker":{"color":"rgba(184,152,199,1)","line":{"color":"rgba(184,152,199,1)"}},"textfont":{"color":"rgba(184,152,199,1)"},"error_y":{"color":"rgba(184,152,199,1)"},"error_x":{"color":"rgba(184,152,199,1)"},"line":{"color":"rgba(184,152,199,1)"},"xaxis":"x","yaxis":"y"},{"x":["209","209","209","209"],"y":[6.1,2.4,7.1,5.3],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"209","marker":{"color":"rgba(197,149,198,1)","line":{"color":"rgba(197,149,198,1)"}},"textfont":{"color":"rgba(197,149,198,1)"},"error_y":{"color":"rgba(197,149,198,1)"},"error_x":{"color":"rgba(197,149,198,1)"},"line":{"color":"rgba(197,149,198,1)"},"xaxis":"x","yaxis":"y"},{"x":["210","210","210","210"],"y":[9.2,9.5,11.7,9.6],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"210","marker":{"color":"rgba(210,145,197,1)","line":{"color":"rgba(210,145,197,1)"}},"textfont":{"color":"rgba(210,145,197,1)"},"error_y":{"color":"rgba(210,145,197,1)"},"error_x":{"color":"rgba(210,145,197,1)"},"line":{"color":"rgba(210,145,197,1)"},"xaxis":"x","yaxis":"y"},{"x":["211","211","211","211"],"y":[52,40.7,56.4,43.3],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"211","marker":{"color":"rgba(222,141,196,1)","line":{"color":"rgba(222,141,196,1)"}},"textfont":{"color":"rgba(222,141,196,1)"},"error_y":{"color":"rgba(222,141,196,1)"},"error_x":{"color":"rgba(222,141,196,1)"},"line":{"color":"rgba(222,141,196,1)"},"xaxis":"x","yaxis":"y"},{"x":["3","3","3","3"],"y":[27.5,30.9,29.5,29.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"3","marker":{"color":"rgba(229,142,191,1)","line":{"color":"rgba(229,142,191,1)"}},"textfont":{"color":"rgba(229,142,191,1)"},"error_y":{"color":"rgba(229,142,191,1)"},"error_x":{"color":"rgba(229,142,191,1)"},"line":{"color":"rgba(229,142,191,1)"},"xaxis":"x","yaxis":"y"},{"x":["301","301","301","301"],"y":[21.8,32.8,21.2,24.6],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"301","marker":{"color":"rgba(222,156,175,1)","line":{"color":"rgba(222,156,175,1)"}},"textfont":{"color":"rgba(222,156,175,1)"},"error_y":{"color":"rgba(222,156,175,1)"},"error_x":{"color":"rgba(222,156,175,1)"},"line":{"color":"rgba(222,156,175,1)"},"xaxis":"x","yaxis":"y"},{"x":["302","302","302","302"],"y":[46.9,51,62.1,60.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"302","marker":{"color":"rgba(214,169,160,1)","line":{"color":"rgba(214,169,160,1)"}},"textfont":{"color":"rgba(214,169,160,1)"},"error_y":{"color":"rgba(214,169,160,1)"},"error_x":{"color":"rgba(214,169,160,1)"},"line":{"color":"rgba(214,169,160,1)"},"xaxis":"x","yaxis":"y"},{"x":["303","303","303","303"],"y":[68.1,66.4,62.4,70.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"303","marker":{"color":"rgba(205,181,144,1)","line":{"color":"rgba(205,181,144,1)"}},"textfont":{"color":"rgba(205,181,144,1)"},"error_y":{"color":"rgba(205,181,144,1)"},"error_x":{"color":"rgba(205,181,144,1)"},"line":{"color":"rgba(205,181,144,1)"},"xaxis":"x","yaxis":"y"},{"x":["304","304","304","304"],"y":[20.3,13.8,14.5,9.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"304","marker":{"color":"rgba(195,192,127,1)","line":{"color":"rgba(195,192,127,1)"}},"textfont":{"color":"rgba(195,192,127,1)"},"error_y":{"color":"rgba(195,192,127,1)"},"error_x":{"color":"rgba(195,192,127,1)"},"line":{"color":"rgba(195,192,127,1)"},"xaxis":"x","yaxis":"y"},{"x":["305","305","305","305"],"y":[9.2,10.8,9.1,6.5],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"305","marker":{"color":"rgba(183,203,110,1)","line":{"color":"rgba(183,203,110,1)"}},"textfont":{"color":"rgba(183,203,110,1)"},"error_y":{"color":"rgba(183,203,110,1)"},"error_x":{"color":"rgba(183,203,110,1)"},"line":{"color":"rgba(183,203,110,1)"},"xaxis":"x","yaxis":"y"},{"x":["306","306","306","306"],"y":[14.2,27.3,21,13.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"306","marker":{"color":"rgba(170,213,90,1)","line":{"color":"rgba(170,213,90,1)"}},"textfont":{"color":"rgba(170,213,90,1)"},"error_y":{"color":"rgba(170,213,90,1)"},"error_x":{"color":"rgba(170,213,90,1)"},"line":{"color":"rgba(170,213,90,1)"},"xaxis":"x","yaxis":"y"},{"x":["307","307","307","307"],"y":[5.6,14.2,12.8,12.6],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"307","marker":{"color":"rgba(177,216,81,1)","line":{"color":"rgba(177,216,81,1)"}},"textfont":{"color":"rgba(177,216,81,1)"},"error_y":{"color":"rgba(177,216,81,1)"},"error_x":{"color":"rgba(177,216,81,1)"},"line":{"color":"rgba(177,216,81,1)"},"xaxis":"x","yaxis":"y"},{"x":["308","308","308","308"],"y":[5.8,7.4,5.7,0],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"308","marker":{"color":"rgba(191,217,76,1)","line":{"color":"rgba(191,217,76,1)"}},"textfont":{"color":"rgba(191,217,76,1)"},"error_y":{"color":"rgba(191,217,76,1)"},"error_x":{"color":"rgba(191,217,76,1)"},"line":{"color":"rgba(191,217,76,1)"},"xaxis":"x","yaxis":"y"},{"x":["309","309","309","309"],"y":[16.1,19.3,19.8,21.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"309","marker":{"color":"rgba(205,217,71,1)","line":{"color":"rgba(205,217,71,1)"}},"textfont":{"color":"rgba(205,217,71,1)"},"error_y":{"color":"rgba(205,217,71,1)"},"error_x":{"color":"rgba(205,217,71,1)"},"line":{"color":"rgba(205,217,71,1)"},"xaxis":"x","yaxis":"y"},{"x":["310","310","310","310"],"y":[12.6,19,9.9,7.3],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"310","marker":{"color":"rgba(218,217,65,1)","line":{"color":"rgba(218,217,65,1)"}},"textfont":{"color":"rgba(218,217,65,1)"},"error_y":{"color":"rgba(218,217,65,1)"},"error_x":{"color":"rgba(218,217,65,1)"},"line":{"color":"rgba(218,217,65,1)"},"xaxis":"x","yaxis":"y"},{"x":["4","4","4","4"],"y":[17.7,20.4,18.4,18.2],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"4","marker":{"color":"rgba(232,217,60,1)","line":{"color":"rgba(232,217,60,1)"}},"textfont":{"color":"rgba(232,217,60,1)"},"error_y":{"color":"rgba(232,217,60,1)"},"error_x":{"color":"rgba(232,217,60,1)"},"line":{"color":"rgba(232,217,60,1)"},"xaxis":"x","yaxis":"y"},{"x":["401","401","401","401"],"y":[20.4,22.8,16.6,18.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"401","marker":{"color":"rgba(244,217,53,1)","line":{"color":"rgba(244,217,53,1)"}},"textfont":{"color":"rgba(244,217,53,1)"},"error_y":{"color":"rgba(244,217,53,1)"},"error_x":{"color":"rgba(244,217,53,1)"},"line":{"color":"rgba(244,217,53,1)"},"xaxis":"x","yaxis":"y"},{"x":["402","402","402","402"],"y":[11.7,19.8,14,15.2],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"402","marker":{"color":"rgba(255,217,51,1)","line":{"color":"rgba(255,217,51,1)"}},"textfont":{"color":"rgba(255,217,51,1)"},"error_y":{"color":"rgba(255,217,51,1)"},"error_x":{"color":"rgba(255,217,51,1)"},"line":{"color":"rgba(255,217,51,1)"},"xaxis":"x","yaxis":"y"},{"x":["403","403","403","403"],"y":[12.2,9.5,8.2,13.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"403","marker":{"color":"rgba(251,213,71,1)","line":{"color":"rgba(251,213,71,1)"}},"textfont":{"color":"rgba(251,213,71,1)"},"error_y":{"color":"rgba(251,213,71,1)"},"error_x":{"color":"rgba(251,213,71,1)"},"line":{"color":"rgba(251,213,71,1)"},"xaxis":"x","yaxis":"y"},{"x":["404","404","404","404"],"y":[6.4,10.2,10.3,7.1],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"404","marker":{"color":"rgba(248,210,88,1)","line":{"color":"rgba(248,210,88,1)"}},"textfont":{"color":"rgba(248,210,88,1)"},"error_y":{"color":"rgba(248,210,88,1)"},"error_x":{"color":"rgba(248,210,88,1)"},"line":{"color":"rgba(248,210,88,1)"},"xaxis":"x","yaxis":"y"},{"x":["405","405","405","405"],"y":[18.3,13.5,23.2,12.6],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"405","marker":{"color":"rgba(244,207,103,1)","line":{"color":"rgba(244,207,103,1)"}},"textfont":{"color":"rgba(244,207,103,1)"},"error_y":{"color":"rgba(244,207,103,1)"},"error_x":{"color":"rgba(244,207,103,1)"},"line":{"color":"rgba(244,207,103,1)"},"xaxis":"x","yaxis":"y"},{"x":["406","406","406","406"],"y":[16,9.7,15.3,14.6],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"406","marker":{"color":"rgba(240,204,117,1)","line":{"color":"rgba(240,204,117,1)"}},"textfont":{"color":"rgba(240,204,117,1)"},"error_y":{"color":"rgba(240,204,117,1)"},"error_x":{"color":"rgba(240,204,117,1)"},"line":{"color":"rgba(240,204,117,1)"},"xaxis":"x","yaxis":"y"},{"x":["407","407","407","407"],"y":[13.8,21.2,18.1,17],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"407","marker":{"color":"rgba(236,200,130,1)","line":{"color":"rgba(236,200,130,1)"}},"textfont":{"color":"rgba(236,200,130,1)"},"error_y":{"color":"rgba(236,200,130,1)"},"error_x":{"color":"rgba(236,200,130,1)"},"line":{"color":"rgba(236,200,130,1)"},"xaxis":"x","yaxis":"y"},{"x":["408","408","408","408"],"y":[21.9,25.3,21,24.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"408","marker":{"color":"rgba(231,197,143,1)","line":{"color":"rgba(231,197,143,1)"}},"textfont":{"color":"rgba(231,197,143,1)"},"error_y":{"color":"rgba(231,197,143,1)"},"error_x":{"color":"rgba(231,197,143,1)"},"line":{"color":"rgba(231,197,143,1)"},"xaxis":"x","yaxis":"y"},{"x":["409","409","409","409"],"y":[21.4,31.9,28.9,26.7],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"409","marker":{"color":"rgba(225,194,151,1)","line":{"color":"rgba(225,194,151,1)"}},"textfont":{"color":"rgba(225,194,151,1)"},"error_y":{"color":"rgba(225,194,151,1)"},"error_x":{"color":"rgba(225,194,151,1)"},"line":{"color":"rgba(225,194,151,1)"},"xaxis":"x","yaxis":"y"},{"x":["410","410","410","410"],"y":[30.5,23,19.9,18.2],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"410","marker":{"color":"rgba(218,192,156,1)","line":{"color":"rgba(218,192,156,1)"}},"textfont":{"color":"rgba(218,192,156,1)"},"error_y":{"color":"rgba(218,192,156,1)"},"error_x":{"color":"rgba(218,192,156,1)"},"line":{"color":"rgba(218,192,156,1)"},"xaxis":"x","yaxis":"y"},{"x":["5","5","5","5"],"y":[12.2,14.8,13.2,13.4],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"5","marker":{"color":"rgba(211,189,160,1)","line":{"color":"rgba(211,189,160,1)"}},"textfont":{"color":"rgba(211,189,160,1)"},"error_y":{"color":"rgba(211,189,160,1)"},"error_x":{"color":"rgba(211,189,160,1)"},"line":{"color":"rgba(211,189,160,1)"},"xaxis":"x","yaxis":"y"},{"x":["501","501","501","501"],"y":[22,32.3,32.6,25.3],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"501","marker":{"color":"rgba(203,187,165,1)","line":{"color":"rgba(203,187,165,1)"}},"textfont":{"color":"rgba(203,187,165,1)"},"error_y":{"color":"rgba(203,187,165,1)"},"error_x":{"color":"rgba(203,187,165,1)"},"line":{"color":"rgba(203,187,165,1)"},"xaxis":"x","yaxis":"y"},{"x":["502","502","502","502"],"y":[16.2,22.1,12.9,20.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"502","marker":{"color":"rgba(195,184,170,1)","line":{"color":"rgba(195,184,170,1)"}},"textfont":{"color":"rgba(195,184,170,1)"},"error_y":{"color":"rgba(195,184,170,1)"},"error_x":{"color":"rgba(195,184,170,1)"},"line":{"color":"rgba(195,184,170,1)"},"xaxis":"x","yaxis":"y"},{"x":["503","503","503","503"],"y":[7.5,6.1,6.8,0.8],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"503","marker":{"color":"rgba(187,182,174,1)","line":{"color":"rgba(187,182,174,1)"}},"textfont":{"color":"rgba(187,182,174,1)"},"error_y":{"color":"rgba(187,182,174,1)"},"error_x":{"color":"rgba(187,182,174,1)"},"line":{"color":"rgba(187,182,174,1)"},"xaxis":"x","yaxis":"y"},{"x":["504","504","504","504"],"y":[7.1,6.1,7.2,6.9],"hoverinfo":["text","text","text","text"],"mode":"markers","frame":null,"type":"scatter","name":"504","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y"}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script> &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
</div>
<div id="regression-model" class="section level2">
<h2>regression model:</h2>
<pre class="r"><code>#set seed for reproducibility
set.seed(10)
#fitting the full model


tidy_asthma = 
  read_csv(file = &quot;./final_data/tidy_asthma.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   geo_type_name = col_character(),
##   geo_join_id = col_double(),
##   time_period = col_double(),
##   geo_place_name = col_character(),
##   homes_with_cockroaches = col_double(),
##   poverty = col_double(),
##   public_school_children_5_14_yrs_old_with_asthma = col_double(),
##   public_school_children_5_14_yrs_old_with_persistent_asthma = col_double(),
##   asthma_hospitalizations_children_5_to_17_yrs_old = col_double()
## )</code></pre>
<pre class="r"><code>test=
  tidy_asthma %&gt;% 
  filter(time_period == c(&quot;2011&quot;, &quot;2014&quot;))

## Model 0 -- crude 
model0_fit = lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches, data=test) %&gt;% broom::tidy()




## Model 1
model1_fit = lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches + poverty + geo_join_id + time_period, data=test) %&gt;% broom::tidy()

model1_fit</code></pre>
<pre><code>## # A tibble: 4 x 5
##   term                   estimate std.error statistic p.value
##   &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)             26.6      11.3        2.35   0.0294
## 2 homes_with_cockroaches   0.383     0.534      0.717  0.482 
## 3 poverty                  0.818     0.637      1.28   0.214 
## 4 geo_join_id              0.0157    0.0229     0.683  0.502</code></pre>
<pre class="r"><code>## Model 2
model2_fit = lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches * poverty * geo_join_id*time_period, data=test) %&gt;% broom::tidy()


# Looking at residuals -- FAILED
#residual_0=
  #model0_fit %&gt;% 
  #modelr::add_residuals(test, model0_fit) %&gt;% 
  #ggplot(aes(x=public_school_children_5_14_yrs_old_with_asthma, y=resid)) +geom_point()

#residual_1=
  #modelr::add_residuals(test, model1_fit) %&gt;% 
  #ggplot(aes(x = public_school_children_5_14_yrs_old_with_asthma, y = resid)) + geom_point()

#residual_2=
  #modelr::add_residuals(tidy_asthma, model2_fit) %&gt;% 
  #ggplot(aes(x = public_school_children_5_14_yrs_old_with_asthma, y = resid)) + geom_point()</code></pre>
</div>
<div id="cross-validation" class="section level2">
<h2>Cross Validation</h2>
<pre class="r"><code>cv_df=
  crossv_mc(tidy_asthma, 100) %&gt;% 
  mutate(
    train=map(train, as_tibble),
    test = map(test, as_tibble)
  )

#cv_df=
 # cv_df %&gt;% 
  #mutate(fit = map(train, ~lm(public_school_children_5_14_yrs_old_with_asthma ~ ., data=.x)),
    #    model1_lm= map(train, ~lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches + poverty + geo_join_id, data=.x)),
     #   model2_lm=map(train, ~lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches * poverty * geo_join_id, data=.x)),
      #  model5_lm=map(train, ~lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches * poverty * geo_join_id * asthma_hospitalizations_children_5_to_17_yrs_old, data=.x))) %&gt;% 
  # mutate(rmse_fit = map2_dbl(fit, test, ~rmse(model=.x, data=.y)),
    #     rmse_model1= map2_dbl(model1_lm, test, ~rmse(model=.x, data=.y)),
     #    rmse_model2= map2_dbl(model2_lm, test, ~rmse(model=.x, data=.y)),
      #   rmse_model5=map2_dbl(model5_lm, test, ~rmse(model=.x, data=.y)))</code></pre>
</div>
<div id="trying-to-do-multi-linear-modeling" class="section level2">
<h2>Trying to do multi-linear modeling</h2>
<pre class="r"><code>library(car)
tidy_asthma = 
  read_csv(file = &quot;./final_data/tidy_asthma.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   geo_type_name = col_character(),
##   geo_join_id = col_double(),
##   time_period = col_double(),
##   geo_place_name = col_character(),
##   homes_with_cockroaches = col_double(),
##   poverty = col_double(),
##   public_school_children_5_14_yrs_old_with_asthma = col_double(),
##   public_school_children_5_14_yrs_old_with_persistent_asthma = col_double(),
##   asthma_hospitalizations_children_5_to_17_yrs_old = col_double()
## )</code></pre>
<pre class="r"><code>tidy_asthma </code></pre>
<pre><code>## # A tibble: 188 x 9
##    geo_type_name geo_join_id time_period geo_place_name homes_with_cock…
##    &lt;chr&gt;               &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;                     &lt;dbl&gt;
##  1 Borough                 1        2011 Bronx                      37.7
##  2 Borough                 2        2011 Brooklyn                   26.6
##  3 Borough                 3        2011 Manhattan                  20.6
##  4 Borough                 4        2011 Queens                     19.7
##  5 Borough                 5        2011 Staten Island               5.2
##  6 Borough                 1        2014 Bronx                      35  
##  7 Borough                 2        2014 Brooklyn                   26.4
##  8 Borough                 3        2014 Manhattan                  19.7
##  9 Borough                 4        2014 Queens                     19.3
## 10 Borough                 5        2014 Staten Island               4.8
## # … with 178 more rows, and 4 more variables: poverty &lt;dbl&gt;,
## #   public_school_children_5_14_yrs_old_with_asthma &lt;dbl&gt;,
## #   public_school_children_5_14_yrs_old_with_persistent_asthma &lt;dbl&gt;,
## #   asthma_hospitalizations_children_5_to_17_yrs_old &lt;dbl&gt;</code></pre>
<pre class="r"><code>ggplot_data = 
tidy_asthma %&gt;%
  filter(time_period == c(&quot;2011&quot;, &quot;2014&quot;))

linear_model = 
  lm(public_school_children_5_14_yrs_old_with_asthma ~ homes_with_cockroaches * poverty * time_period * geo_join_id, data = ggplot_data) %&gt;%
  broom::glance()
layout(matrix(c(1,2,3,4),2,2))
plot(linear_model)</code></pre>
<p><img src="kelly_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
